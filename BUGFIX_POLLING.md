# ğŸ› ë²„ê·¸ ìˆ˜ì •: ê·¸ë£¹ì¥ í™”ë©´ ì‹¤ì‹œê°„ ì—…ë°ì´íŠ¸

## ë¬¸ì œì 
**ì¦ìƒ**: ê·¸ë£¹ì¥ í™”ë©´ì—ì„œ ìƒˆ ê·¸ë£¹ì›ì´ ì°¸ê°€í•´ë„ í™”ë©´ì´ ìë™ìœ¼ë¡œ ê°±ì‹ ë˜ì§€ ì•ŠìŒ

**ì›ì¸ ë¶„ì„**:
1. í´ë§ ê°„ê²©ì´ 5ì´ˆë¡œ ë„ˆë¬´ ê¸¸ì–´ì„œ ìµœëŒ€ 5ì´ˆì˜ ì§€ì—° ë°œìƒ
2. `fetchGroupData` í•¨ìˆ˜ì˜ ì˜ì¡´ì„± ë°°ì—´ ë¬¸ì œ
3. ë¸Œë¼ìš°ì € ìºì‹œë¡œ ì¸í•´ ìµœì‹  ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¤ì§€ ëª»í•¨

## í•´ê²° ë°©ë²•

### 1. í´ë§ ê°„ê²© ë‹¨ì¶•
**ë³€ê²½ ì „**: 5ì´ˆë§ˆë‹¤ í´ë§
```typescript
const interval = setInterval(fetchGroupData, 5000);
```

**ë³€ê²½ í›„**: 2ì´ˆë§ˆë‹¤ í´ë§
```typescript
const interval = setInterval(fetchGroupData, 2000);
```

**íš¨ê³¼**: ìµœëŒ€ ì§€ì—° ì‹œê°„ì´ 5ì´ˆ â†’ 2ì´ˆë¡œ ê°ì†Œ (60% ê°œì„ )

### 2. ìºì‹œ ë°©ì§€ í—¤ë” ì¶”ê°€
```typescript
const response = await fetch(`/api/group/${groupId}`, {
  headers: {
    'Cache-Control': 'no-cache',
    'Pragma': 'no-cache'
  }
});
```

**íš¨ê³¼**: ë¸Œë¼ìš°ì €ê°€ ìºì‹œëœ ë°ì´í„°ê°€ ì•„ë‹Œ ìµœì‹  ë°ì´í„°ë¥¼ í•­ìƒ ê°€ì ¸ì˜´

### 3. ìƒˆ ë©¤ë²„ ì°¸ê°€ ê°ì§€ ë¡œê¹…
```typescript
// ìƒˆ ë©¤ë²„ ì°¸ê°€ ê°ì§€
if (newMembers.length > members.length) {
  const newMember = newMembers.find(
    (nm: GroupMember) => !members.some(m => m.sessionId === nm.sessionId)
  );
  if (newMember && newMember.sessionId !== sessionId) {
    console.log(`ìƒˆ ë©¤ë²„ ì°¸ê°€: ${newMember.profile?.nickname} (${newMember.position})`);
  }
}
```

**íš¨ê³¼**: ê°œë°œì ë„êµ¬ ì½˜ì†”ì—ì„œ ì‹¤ì‹œê°„ ì—…ë°ì´íŠ¸ í™•ì¸ ê°€ëŠ¥

### 4. ë§¤ì¹­ ì™„ë£Œ ì‹œ í´ë§ ì¤‘ì§€
```typescript
useEffect(() => {
  fetchGroupData();
  
  // ë§¤ì¹­ ì™„ë£Œ ì „ì—ë§Œ í´ë§ ê³„ì†
  if (status === 'waiting') {
    const interval = setInterval(fetchGroupData, 2000);
    return () => clearInterval(interval);
  }
}, [groupId, status]);
```

**íš¨ê³¼**: ë§¤ì¹­ ì™„ë£Œ í›„ ë¶ˆí•„ìš”í•œ API í˜¸ì¶œ ë°©ì§€, ì„œë²„ ë¶€í•˜ ê°ì†Œ

## í…ŒìŠ¤íŠ¸ ë°©ë²•

### ì‹œë‚˜ë¦¬ì˜¤ 1: ê·¸ë£¹ì¥ì´ ìƒˆ ë©¤ë²„ ì°¸ê°€ í™•ì¸
1. **ë¸Œë¼ìš°ì € A** (ê·¸ë£¹ì¥):
   - í”„ë¡œí•„ ìƒì„± (ì˜ˆ: Tank)
   - "ê·¸ë£¹ì¥ìœ¼ë¡œ ì‹œì‘" í´ë¦­
   - ê·¸ë£¹ ëŒ€ê¸°ì‹¤ í™”ë©´ í‘œì‹œ

2. **ë¸Œë¼ìš°ì € B** (ê·¸ë£¹ì›):
   - í”„ë¡œí•„ ìƒì„± (ì˜ˆ: Damage)
   - "ê·¸ë£¹ì›ìœ¼ë¡œ ì‹œì‘" í´ë¦­

3. **ê¸°ëŒ€ ê²°ê³¼**:
   - ë¸Œë¼ìš°ì € Aì—ì„œ **ìµœëŒ€ 2ì´ˆ ì´ë‚´**ì— ìƒˆ ë©¤ë²„ í‘œì‹œ
   - ë©¤ë²„ ì¹´ìš´íŠ¸ ì—…ë°ì´íŠ¸ (1/5 â†’ 2/5)
   - ê°œë°œì ì½˜ì†”ì— "ìƒˆ ë©¤ë²„ ì°¸ê°€" ë¡œê·¸ í‘œì‹œ

### ì‹œë‚˜ë¦¬ì˜¤ 2: ì—¬ëŸ¬ ë©¤ë²„ ìˆœì°¨ ì°¸ê°€
1. ê·¸ë£¹ì¥ 1ëª… ìƒì„±
2. ê·¸ë£¹ì› 4ëª… ìˆœì°¨ ì°¸ê°€
3. ê° ë©¤ë²„ê°€ ì°¸ê°€í•  ë•Œë§ˆë‹¤ ê·¸ë£¹ì¥ í™”ë©´ì´ 2ì´ˆ ì´ë‚´ ì—…ë°ì´íŠ¸ í™•ì¸

### ì‹œë‚˜ë¦¬ì˜¤ 3: ë§¤ì¹­ ì™„ë£Œ í›„ í´ë§ ì¤‘ì§€
1. 5ëª… ë§¤ì¹­ ì™„ë£Œ
2. ê°œë°œì ë„êµ¬ Network íƒ­ í™•ì¸
3. ë” ì´ìƒ `/api/group/[groupId]` ìš”ì²­ì´ ë°œìƒí•˜ì§€ ì•ŠìŒ

## ì¶”ê°€ ê°œì„  ì‚¬í•­

### ë‹¨ê¸° ê°œì„  (í˜„ì¬ ì ìš©ë¨)
- âœ… í´ë§ ê°„ê²© 5ì´ˆ â†’ 2ì´ˆ ë‹¨ì¶•
- âœ… ìºì‹œ ë°©ì§€ í—¤ë” ì¶”ê°€
- âœ… ìƒˆ ë©¤ë²„ ì°¸ê°€ ë¡œê¹…
- âœ… ë§¤ì¹­ ì™„ë£Œ ì‹œ í´ë§ ì¤‘ì§€

### ì¥ê¸° ê°œì„  (ê¶Œì¥ì‚¬í•­)
1. **Supabase Realtime êµ¬ë…**
   - í´ë§ ë°©ì‹ â†’ ì‹¤ì‹œê°„ ì´ë²¤íŠ¸ ê¸°ë°˜
   - 0.1ì´ˆ ì´ë‚´ ì—…ë°ì´íŠ¸ ê°€ëŠ¥
   - ì„œë²„ ë¶€í•˜ ê°ì†Œ
   
   ```typescript
   const channel = supabase
     .channel(`group:${groupId}`)
     .on('postgres_changes', {
       event: '*',
       schema: 'public',
       table: 'group_members',
       filter: `group_id=eq.${groupId}`
     }, (payload) => {
       fetchGroupData();
     })
     .subscribe();
   ```

2. **ë‚™ê´€ì  UI ì—…ë°ì´íŠ¸**
   - API ì‘ë‹µ ì „ì— UI ë¨¼ì € ì—…ë°ì´íŠ¸
   - ë” ë¹ ë¥¸ ì‚¬ìš©ì ê²½í—˜

3. **WebSocket ì—°ê²°**
   - Pusher, Ably ë“±ì˜ ì„œë¹„ìŠ¤ í™œìš©
   - ì‹¤ì‹œê°„ ì–‘ë°©í–¥ í†µì‹ 

## ì„±ëŠ¥ ë¹„êµ

| í•­ëª© | ìˆ˜ì • ì „ | ìˆ˜ì • í›„ | ê°œì„ ìœ¨ |
|------|---------|---------|--------|
| í´ë§ ê°„ê²© | 5ì´ˆ | 2ì´ˆ | **60% ê°œì„ ** |
| ìµœëŒ€ ì§€ì—° | 5ì´ˆ | 2ì´ˆ | **60% ê°œì„ ** |
| ìºì‹œ ë¬¸ì œ | ë°œìƒ ê°€ëŠ¥ | í•´ê²°ë¨ | **100% í•´ê²°** |
| ë§¤ì¹­ ì™„ë£Œ í›„ í´ë§ | ê³„ì† | ì¤‘ì§€ | **ë¶ˆí•„ìš”í•œ ìš”ì²­ ì œê±°** |

## ê´€ë ¨ íŒŒì¼
- `components/group/GroupLobby.tsx` - ìˆ˜ì •ëœ ì»´í¬ë„ŒíŠ¸
- `app/api/group/[groupId]/route.ts` - API ì—”ë“œí¬ì¸íŠ¸

## ì»¤ë°‹ ì •ë³´
- Commit: [ìë™ ìƒì„±]
- Message: "Fix: Improve real-time group updates (5s â†’ 2s polling, add cache headers)"
- Files changed: 1

## ì°¸ê³ 
- Next.js ê³µì‹ ë¬¸ì„œ: [Data Fetching](https://nextjs.org/docs/app/building-your-application/data-fetching)
- Supabase Realtime: [Realtime Documentation](https://supabase.com/docs/guides/realtime)
